<!-- כותרת -->
<div class="mb-4">
  <h2 class="text-primary">
    <i class="bi bi-shop"></i>
    <span *ngIf="selectedCategoryId === null">כל המוצרים</span>
    <span *ngIf="selectedCategoryId === 1">סמארטפונים וטאבלטים</span>
    <span *ngIf="selectedCategoryId === 2">מחשבים וטלוויזיות</span>
  </h2>
  <p class="text-muted">נמצאו {{ filteredProducts.length }} מוצרים</p>
</div>

<!-- מצב טעינה -->
<div *ngIf="isLoading" class="text-center p-5">
  <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
    <span class="visually-hidden">טוען...</span>
  </div>
  <p class="mt-3">טוען מוצרים...</p>
</div>

<!-- הודעה אם אין מוצרים -->
<div *ngIf="!isLoading && filteredProducts.length === 0" class="alert alert-info text-center">
  <i class="bi bi-info-circle fs-1"></i>
  <h4 class="mt-3">לא נמצאו מוצרים בקטגוריה זו</h4>
  <p>נסה לבחור קטגוריה אחרת</p>
</div>

<!-- רשת מוצרים -->
<div *ngIf="!isLoading && filteredProducts.length > 0" class="row g-4">
  
  <div *ngFor="let product of filteredProducts" class="col-12 col-sm-6 col-lg-4 col-xl-3">
    <div class="card h-100 shadow-sm product-card">
      
      <!-- תמונת מוצר -->
      <img [src]="product.image" 
           [alt]="product.name" 
           class="card-img-top"
           style="height: 200px; object-fit: contain;">
      
      <!-- תג במלאי/אזל -->
      <span class="badge position-absolute top-0 end-0 m-2"
            [class.bg-success]="product.inStock"
            [class.bg-danger]="!product.inStock">
        {{ product.inStock ? '✓ במלאי' : '✗ אזל' }}
      </span>
      
      <div class="card-body d-flex flex-column">
        
        <!-- שם מוצר -->
        <h5 class="card-title">{{ product.name }}</h5>
        
        <!-- מותג -->
        <p class="card-text text-muted mb-2">
          <small>🏷️ {{ product.brand }}</small>
        </p>
        
        <!-- קטגוריה -->
        <p class="card-text text-secondary mb-2">
          <small>📂 {{ product.category }}</small>
        </p>
        
        <!-- מחיר -->
        <p class="card-text text-primary fs-4 fw-bold">
          ₪{{ product.price }}
        </p>
        
        <!-- מלאי -->
        <p class="card-text text-muted mb-3">
          <small>במלאי: {{ product.remainingStock }} יחידות</small>
        </p>
        
        <!-- Progress bar של מכירות -->
        <div class="mb-3">
          <small class="text-muted">נמכרו: {{ product.soldCount }}/{{ product.stock }}</small>
          <div class="progress" style="height: 8px;">
            <div class="progress-bar" 
                 [class.bg-warning]="product.salesPercentage >= 50 && product.salesPercentage < 80"
                 [class.bg-danger]="product.salesPercentage >= 80"
                 role="progressbar" 
                 [style.width.%]="product.salesPercentage">
            </div>
          </div>
        </div>
        
        <!-- כפתורים -->
        <div class="mt-auto">
          <button class="btn btn-primary w-100 mb-2" 
                  [disabled]="!product.inStock">
            <i class="bi bi-cart-plus"></i>
            {{ product.inStock ? 'הוסף לסל' : 'אזל מהמלאי' }}
          </button>
          
          <button class="btn btn-outline-secondary w-100"
                  (click)="viewProductDetails(product.id)">
            <i class="bi bi-eye"></i>
            פרטים נוספים
          </button>
        </div>
        
      </div>
    </div>
  </div>
  
</div>